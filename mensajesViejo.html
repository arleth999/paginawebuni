<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mensajes Arleth López 1890-17-23444 </title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
</head>

<body class="bg-light">
<div class="container mt-5">

  <h3 class="fw-bold text-primary mb-4 text-center">serie III: mensajes</h3>

  <p class="text-center text-muted">lectura desde SQL Server</p>

  <button class="btn btn-outline-primary mb-3" onclick="cargarMensajes()">Actualizar</button>

  <ul id="lista" class="list-group shadow"></ul>

</div>

<script>
// conexion a sql server por medio de API proxy 
async function cargarMensajes() {
  const lista = document.getElementById("lista");
  lista.innerHTML = "<li class='list-group-item'>Cargando...</li>";

  // usamos un backend publico para obtener los mensajes
  const resp = await fetch("https://backcvbgtmdesa.azurewebsites.net/api/chatmensajes");
  const data = await resp.json();

  lista.innerHTML = "";

  data.forEach(row => {
    const li = document.createElement("li");
    li.className = "list-group-item";
    li.innerHTML = `
      <strong>${row.Login_Emisor}</strong> — 
      <span class="text-muted">${row.FechaHora}</span>
      <br>${row.Contenido}
    `;
    lista.appendChild(li);
  });
}
</script>

</body>
</html>
